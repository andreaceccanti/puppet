[SERVICE]
entityId = https://<%= @pep_host %>/pepd
hostname = <%= @pep_host %>
port = <%= @pep_port %>
adminPort = <%= @pep_admin_port %>
adminPassword = <%= @pep_admin_port %>

# PIPs to apply on incoming request
pips = REQVALIDATOR_PIP OPENSSLSUBJECT_PIP GLITEXACMLPROFILE_PIP COMMONXACMLPROFILE_PIP
# OHs to apply on response
obligationHandlers = ACCOUNTMAP_OH

[PDP]
pdps = https://<%= scope.lookupvar("argus::params::pdp_host") %>:<%= scope.lookupvar("argus::params::pdp_port") %>/authz

[SECURITY]
serviceCertificate = <%= @certificate_path %>
servicePrivateKey = <%= @private_key_path %>
trustInfoDir = <%= @trust_info_dir %>
enableSSL = <%= @enable_ssl %>
requireClientCertAuthentication = <%= @req_client_cert_auth %>

#
# Policy Information Points (PIP) configuration
#
[REQVALIDATOR_PIP]
parserClass = org.glite.authz.pep.pip.provider.RequestValidatorPIPIniConfigurationParser
validateRequestSubjects = true
validateRequestResources = true
validateRequestAction = true
validateRequestEnvironment = false

[OPENSSLSUBJECT_PIP]
parserClass = org.glite.authz.pep.pip.provider.OpenSSLSubjectPIPIniConfigurationParser
opensslSubjectAttributeIDs = http://glite.org/xacml/attribute/subject-issuer urn:oasis:names:tc:xacml:1.0:subject:subject-id
opensslSubjectAttributeDatatypes = http://www.w3.org/2001/XMLSchema#string

[GLITEXACMLPROFILE_PIP]
parserClass = org.glite.authz.pep.pip.provider.AuthorizationProfilePIPIniConfigurationParser
vomsInfoDir = /etc/grid-security/vomsdir
acceptedProfileIDs = http://glite.org/xacml/profile/grid-ce/1.0 http://glite.org/xacml/profile/grid-wn/1.0

[COMMONXACMLPROFILE_PIP]
parserClass = org.glite.authz.pep.pip.provider.CommonXACMLAuthorizationProfilePIPIniConfigurationParser
vomsInfoDir = /etc/grid-security/vomsdir
acceptedProfileIDs = http://dci-sec.org/xacml/profile/common-authz/1.1

#
# Obligation Handlers (OH) configuration
#
[ACCOUNTMAP_OH]
parserClass = org.glite.authz.pep.obligation.dfpmap.DFPMObligationHandlerConfigurationParser
accountMapFile = <%= @account_map_file %>
groupMapFile = <%= @group_map_file %>
gridMapDir = <%= @grid_map_dir %>

